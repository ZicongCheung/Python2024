1.累计收益=持有价值−投入本金+赎回金额

投入本金=（transaction表中本基金transaction_type买入与定投的transaction_amount的和）+（transaction表中本基金transaction_type为买入与定投的transaction_fee的和）+（conversion_details表中本基金transaction_amount的和）+（conversion_details表中本基金transaction_fee的和）

赎回金额=（transaction表中本基金transaction_type为卖出的confirmed_shares的和）+（transaction表中本基金transaction_type为转换的confirmed_shares的和）

2.时间区间内的收益=时间区间前持有的基金份额*（当前基金最新净值-时间区间前最后交易日净值）+时间区间内购入的基金份额的收益+时间区间内卖出/转换的基金份额的收益-时间区间内购入的基金的手续费

时间区间内购入的基金份额的收益=（transaction表中时间区间内本基金每次transaction_type买入与定投的confirmed_shares*（当前基金最新净值-transaction表中时间区间内本基金每次transaction_type买入与定投的confirmed_nav）+conversion_details表中时间区间内本基金每次的confirmed_shares*（当前基金最新净值-conversion_details中时间区间内本基金每次的confirmed_nav））的和

时间区间内卖出/转换的基金份额的收益=（transaction表中时间区间内本基金transaction_type卖出/转换的transaction_amount*（时间区间内每次卖出/转换的confirmed_shares-时间区间前最后交易日净值））的和

时间区间内购入的基金的手续费=transaction表中时间区间内本基金transaction_type买入与定投的transaction_fee + conversion_details中时间区间内本基金每次的transaction_fee